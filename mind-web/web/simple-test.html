<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIND - Test</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #333333;
        }
        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
        }
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: -apple-system, sans-serif;
            padding: 20px;
        }
        .button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
        }
        .status { margin: 20px 0; padding: 10px; background: var(--bg-secondary); border-radius: 6px; }
        .chat { margin-top: 20px; }
        textarea { width: 100%; height: 100px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ðŸ§  MIND - Working Test Version</h1>
    
    <div class="status" id="status">Checking Ollama...</div>
    
    <button class="button" id="themeBtn">ðŸŒ™ Toggle Dark Mode</button>
    <button class="button" id="testOllama">Test Ollama Connection</button>
    
    <div class="chat">
        <h3>Chat with @strategist</h3>
        <textarea id="message" placeholder="Type your message..."></textarea>
        <button class="button" id="sendBtn">Send</button>
        <div id="response"></div>
    </div>

    <script>
        // Theme toggle
        let isDark = false;
        document.getElementById('themeBtn').addEventListener('click', () => {
            isDark = !isDark;
            document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
            document.getElementById('themeBtn').textContent = isDark ? 'â˜€ï¸ Toggle Light Mode' : 'ðŸŒ™ Toggle Dark Mode';
            console.log('Theme toggled:', isDark ? 'dark' : 'light');
        });

        // Check Ollama status
        async function checkOllama() {
            try {
                const res = await fetch('/api/ollama/status');
                const data = await res.json();
                document.getElementById('status').innerHTML = 
                    data.available 
                        ? 'âœ… Ollama Connected: ' + data.models.join(', ') 
                        : 'âŒ Ollama Not Available';
            } catch (e) {
                document.getElementById('status').innerHTML = 'âŒ Error: ' + e.message;
            }
        }
        
        checkOllama();
        
        document.getElementById('testOllama').addEventListener('click', checkOllama);

        // Chat
        document.getElementById('sendBtn').addEventListener('click', async () => {
            const msg = document.getElementById('message').value;
            if (!msg) return;
            
            document.getElementById('response').innerHTML = 'Thinking...';
            
            try {
                const res = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: msg, agent: 'strategist' })
                });
                const data = await res.json();
                document.getElementById('response').innerHTML = 
                    '<strong>@strategist:</strong> ' + (data.response || data.error || 'No response');
            } catch (e) {
                document.getElementById('response').innerHTML = 'Error: ' + e.message;
            }
        });
    </script>
</body>
</html>